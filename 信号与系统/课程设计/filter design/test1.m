%用频率抽样法设计一个FIR数字低通滤波器，
%截止频率wc=0.2pi
clc;
close all;
clear all;
%取M=20(偶数)
M=20;
alpha=(M-1)/2;
l=0:M-1;
wl=(2*pi/M)*l;
Hrs=[1,1,zeros(1,17),1];
hdr=[1,1,0,0];
wdl=[0,0.2,0.2,1];
k1=0:floor((M-1)/2);
k2=floor((M-1)/2)+1:M-1;
angH=[-alpha*(2*pi)/M*k1,alpha*(2*pi)/M*(M-k2)];
HH=Hrs.*exp(j*angH);
h=real(ifft(HH,M));
[H,w]=freqz(h,1,1000,'whole');
H=(H(1:501))';
w=(w(1:501))';
mag=abs(H);
db=20*log10((mag+eps)/max(mag));
pha=angle(H); 
L=M/2;
b=2*[h(L:-1:1)];
n=[1:1:L];
n=n-0.5;
w=[0:1:500]'*pi/500;
Hr=cos(w*n)*b';
figure(1);
%221位置的图
subplot(2,2,1);
plot(wl(1:11)/pi,Hrs(1:11),'o',wdl,hdr);
title('频率样本:M=20');
ylabel('|Hd|');
axis([0,1,-0.1,1.1]);
set(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);
set(gca,'YTickMode','manual','YTick',[0,1]);
grid;
%222位置的图
subplot(2,2,2);
stem(l,h);
title('冲激响应');
xlabel('n');
ylabel('h(n)');
axis([0,M,-0.1,0.3]);
%223位置的图
subplot(2,2,3);
plot(w/pi,Hr,wl(1:11)/pi,Hrs(1:11),'o');
title('振幅响应,没取绝对值');
xlabel('频率(单位:pi)');
ylabel('H(k)');
axis([0,1,-0.2,1.1]);
set(gca,'XTickMode','manual','XTick',[0,0.2,0.3,1]);
set(gca,'YTickMode','manual','YTick',[0,1]);
grid;
%224位置的图
subplot(2,2,4);
plot(w/pi,abs(Hr));
title('幅度响应,取绝对值后的');
set(gca,'XLim',[0,1],'XTick',0:0.2:1,'XTickLabel',0:0.2:1);
set(gca,'YLim',[0,1],'YTick',0:0.2:1,'YTickLabel',0:0.2:1);
grid;
xlabel('频率(单位:pi)');
ylabel('幅度');
axis([0,1,0,1.2]);